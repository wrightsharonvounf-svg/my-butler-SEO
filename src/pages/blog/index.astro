---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('posts');

// группируем по категориям
const categories = posts.reduce((acc, post) => {
  const [category] = post.id.split('/');
  acc[category] = acc[category] || [];
  acc[category].push(post);
  return acc;
}, {});
---

<Layout
  title="Блог о недвижимости и финансах"
  description="Информационный блог о недвижимости, аренде, ипотеке, налогах и инвестициях. Актуальные статьи и разборы."
>
  <section style="max-width: 900px; margin: 0 auto; padding: 2rem 1rem;">

    <h1>Блог о недвижимости и финансах</h1>

    <p>
      В этом блоге мы публикуем полезные статьи об аренде недвижимости,
      ипотеке, налогах, инвестициях и управлении жильём.
    </p>

    {Object.entries(categories).map(([category, items]) => (
      <section style="margin-top: 2rem;">
        <h2>{category}</h2>

        <ul>
          {items.map(post => (
            <li>
              <a href={`/blog/${category}/${post.slug}/`}>
                {post.data.title}
              </a>
            </li>
          ))}
        </ul>
      </section>
    ))}

  </section>
</Layout>

